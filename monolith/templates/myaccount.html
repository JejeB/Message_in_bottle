<html lang="en">
  <head>
    <title>My Message in a Bottle -- Primer</title>
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">
    <meta charset="utf-8">
  </head>
  <body class="p-centered" style="width: max-content;">
    <header class="navbar" style="margin-top: 1%;">
      <section class="navbar-section">
        <a href="/" class="btn btn-link"><i class="icon icon-menu"></i> Home</a>
        <a href="/myaccount" class="btn btn-link"><i class="icon icon-people"></i> My account</a>
        <a href="/message/new" class="btn btn-link"><i class="icon icon-message"></i> Send a message</a>
        <a href="#" class="btn btn-link badge" data-badge="8"><i class="icon icon-mail"></i> Mailbox</a>
      </section>
    </header>
<h1>My account</h1>
  
  <div class="panel">
    <div class="panel-header text-center">
      <figure ><i class="icon icon-people"></i></figure>
      <div class="panel-title h5 mt-10">{{ current_user.firstname }}</div>
      <div class="panel-subtitle">{{ current_user.lastname }}</div>
    </div>
    <div class="panel-body">
      <div class="tile tile-centered">
        <div class="tile-content">
          <div class="tile-title text-bold">E-mail</div>
          <div class="tile-subtitle">{{ current_user.email }}</div>
        </div>
        <div class="tile-action">
          <button class="btn btn-link btn-action btn-lg tooltip tooltip-left" data-tooltip="Edit E-mail"><i class="icon icon-edit"></i></button>
        </div>
      </div>
      <div class="tile tile-centered">
        <div class="tile-content">
          <div class="tile-title text-bold">Date of birth</div>
          <div class="tile-subtitle">{{ current_user.date_of_birth.strftime('%d/%m/%Y') }}</div>
        </div>
        <div class="tile-action">
          <button class="btn btn-link btn-action btn-lg"><i class="icon icon-edit"></i></button>
        </div>
      </div>
    </div>
    <div class="panel-footer">
      <button onclick="openmodal()" class="btn btn-error p-centered" >Delete my account</button>
    </div>
  </div>
  <div class="modal " id="delete_modal">
    <a href="#close" class="modal-overlay" aria-label="Close"></a>
    <div class="modal-container">
      <div class="modal-header">
        <a href="#close" class="btn btn-clear float-right" aria-label="Close"></a>
        <div class="modal-title h5">Are you sure to delete your account ?</div>
      </div>
      <div class="modal-body">
        <div class="content">
          By delete your account your wont be able to login again and receive new messages.
        </div>
      </div>
      <div class="modal-footer">
        <button onclick="senddelete()" class="btn btn-error" >Delete</button>
        <button onclick="closemodal()" class="btn btn-link" >Close</button>
      </div>
    </div>
  </div>
 <script>
   function senddelete(){
    fetch('/myaccount', {
      method: 'DELETE'
    }).then(response => {
      if (response.redirected) {
        window.location.replace(response.url);
      }
    })
   };
   function openmodal(){
    document.getElementById("delete_modal").classList.add('active');
   }
   function closemodal(){
    document.getElementById("delete_modal").classList.remove('active');
   }
 </script>
 </body>
 </html>